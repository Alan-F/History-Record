alter table asiainfo_mon_qx_4_4g_test add LOST_TAG_4_T3_4G NUMBER;
update asiainfo_mon_qx_4_4g_test set LOST_TAG_4_T3_4G=-1;

update asiainfo_mon_qx_4_4g_test set LOST_TAG_4_T3_4G=1 where
(lost_tag_201501=0 and lost_tag_201502=0 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=1 )
or (lost_tag_201501=2 and lost_tag_201502=0 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=1)
or(lost_tag_201501=2 and lost_tag_201502=2 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=1)
or(lost_tag_201501=2 and lost_tag_201502=2 and lost_tag_201503=2 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=1);

update asiainfo_mon_qx_4_4g_test set LOST_TAG_4_T3_4G=0 where
(lost_tag_201501=0 and lost_tag_201502=0 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=0)
or (lost_tag_201501=2 and lost_tag_201502=0 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=0)
or(lost_tag_201501=2 and lost_tag_201502=2 and lost_tag_201503=0 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=0)
or(lost_tag_201501=2 and lost_tag_201502=2 and lost_tag_201503=2 and lost_tag_201504=0 and lost_tag_201505=0 and lost_tag_201506=0 and lost_tag_201507=0);

select count(*),	LOST_TAG_4_T3_4G	 from asiainfo_mon_qx_4_4g_test  group by	lost_tag_4_T3_4g	;

#6
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (NO_LCALL_DURATION_201503=0 and NO_LCALL_DURATION_201504=0 and NO_LCALL_DURATION_201505=0 ) group by	LOST_TAG_4_T3_4G	;

#7
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (CZ_FEE_01_201503=0 and CZ_FEE_01_201504=0 and CZ_FEE_01_201505=0) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (CZ_FEE_01_201502=0 and CZ_FEE_01_201503=0 and CZ_FEE_01_201504=0 and CZ_FEE_01_201505=0) group by	LOST_TAG_4_T3_4G	;

#8
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( BILL_DURATION_01_201504=0 and BILL_DURATION_01_201505=0) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( BILL_DURATION_01_201503=0  and BILL_DURATION_01_201504=0 and BILL_DURATION_01_201505=0) group by	LOST_TAG_4_T3_4G	;

#9
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( PROV_LCALL_DURATION_201504=0 and PROV_LCALL_DURATION_201505=0) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( PROV_LCALL_DURATION_201503=0 and PROV_LCALL_DURATION_201504=0 and PROV_LCALL_DURATION_201505=0) group by	LOST_TAG_4_T3_4G	;

#10
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( NATIONAL_LCALL_DURATION_201503=0 and	NATIONAL_LCALL_DURATION_201504=0 and 	NATIONAL_LCALL_DURATION_201505=0) group by	LOST_TAG_4_T3_4G	;

#11
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (CUR_INCOME_201504	<=1000 and CUR_INCOME_201505<=1000) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (CUR_INCOME_201504	=1000 and CUR_INCOME_201505=1000) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( CUR_INCOME_201504>CUR_INCOME_201505 and CUR_INCOME_201503>CUR_INCOME_201504 ) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( CUR_INCOME_201503>CUR_INCOME_201505+CUR_INCOME_201504 ) group by	LOST_TAG_4_T3_4G	;

#12
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (  NOT_PACKAGE_USE_201503_201503=0 and NOT_PACKAGE_USE_201504_201504=0 and NOT_PACKAGE_USE_201505_201505=0) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (  NOT_PACKAGE_USE_201501_201501+NOT_PACKAGE_USE_201502_201502+NOT_PACKAGE_USE_201503_201503+NOT_PACKAGE_USE_201504_201504+NOT_PACKAGE_USE_201505_201505<0.1) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (  NOT_PACKAGE_USE_201501_201501<0.1 and NOT_PACKAGE_USE_201502_201502<0.1 and NOT_PACKAGE_USE_201503_201503<0.1 and NOT_PACKAGE_USE_201504_201504<0.1 and NOT_PACKAGE_USE_201505_201505<0.1) group by	LOST_TAG_4_T3_4G	;

#13
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( FREE_FLOW_USE_201503=0 and FREE_FLOW_USE_201504=0 and FREE_FLOW_USE_201505=0) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( FREE_FLOW_USE_201503<1 and FREE_FLOW_USE_201504<1 and FREE_FLOW_USE_201505<1) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where ( FREE_FLOW_USE_201504>=FREE_FLOW_USE_201505) group by	LOST_TAG_4_T3_4G	;

#14
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (SMS_NUMS_201504+SMS_NUMS_201505<=SMS_NUMS_201503 and SMS_NUMS_201505<=SMS_NUMS_201504) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (SMS_NUMS_201504=0 and SMS_NUMS_201505=0  ) group by	LOST_TAG_4_T3_4G	;
select count(*), LOST_TAG_4_T3_4G	 from ASIAINFO_MON_QX_4_4G_TEST  where (SMS_NUMS_201504=0 and SMS_NUMS_201505=0 and (SMS_NUMS_201503!=0 or SMS_NUMS_201502!=0 or SMS_NUMS_201501!=0) ) group by	LOST_TAG_4_T3_4G	;

#15
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE ROAM_STREAM_01_201505<=0.5*(ROAM_STREAM_01_201503+ROAM_STREAM_01_201504) GROUP BY LOST_TAG_4_T3_4G;
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE( ROAM_STREAM_01_201505<=0.5*ROAM_STREAM_01_201504 and ROAM_STREAM_01_201504>=0.5*ROAM_STREAM_01_201503) GROUP BY LOST_TAG_4_T3_4G;
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE( ROAM_STREAM_01_201505=0 or ROAM_STREAM_01_201505<=0.05*(ROAM_STREAM_01_201503+ROAM_STREAM_01_201504)) GROUP BY LOST_TAG_4_T3_4G;

#16
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE( PROM_FEE_201501<2000 and PROM_FEE_201502<2000 and PROM_FEE_201503<2000 and PROM_FEE_201504<2000 and PROM_FEE_201505<2000) GROUP BY LOST_TAG_4_T3_4G;
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE( PROM_FEE_201505<PROM_FEE_201504) GROUP BY LOST_TAG_4_T3_4G;
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE PROM_FEE_201505!=0 and case when PROM_FEE_201505>PROM_FEE_201504 THEN 1 ELSE 0 END+case when PROM_FEE_201505>PROM_FEE_201503 THEN 1 ELSE 0 END+case when PROM_FEE_201505>PROM_FEE_201502 THEN 1 ELSE 0 END+case when PROM_FEE_201505>PROM_FEE_201501 THEN 1 ELSE 0 END >=1 GROUP BY LOST_TAG_4_T3_4G;

#17
select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST 
WHERE((DEBT_FEE_201501=0 and DEBT_FEE_201502=0 and DEBT_FEE_201503=0 and DEBT_FEE_201504=0 and DEBT_FEE_201505>1000) or (DEBT_FEE_201501=0 and DEBT_FEE_201502=0 and DEBT_FEE_201503>1000 and DEBT_FEE_201504>1000 and DEBT_FEE_201505<1000))
GROUP BY LOST_TAG_4_T3_4G;

select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST 
WHERE((DEBT_FEE_201501=0 and DEBT_FEE_201502=0 and DEBT_FEE_201503=0 and DEBT_FEE_201504=0 and DEBT_FEE_201505!=0) or (DEBT_FEE_201501=0 and DEBT_FEE_201502=0 and DEBT_FEE_201503!=0 and DEBT_FEE_201504!=0 and DEBT_FEE_201505=0))
GROUP BY LOST_TAG_4_T3_4G;

select count(*),  LOST_TAG_4_T3_4G FROM ASIAINFO_MON_QX_4_4G_TEST WHERE(DEBT_FEE_201501!=0 and DEBT_FEE_201504!=0 ) GROUP BY LOST_TAG_4_T3_4G;

